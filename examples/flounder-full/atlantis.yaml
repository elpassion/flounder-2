version: 3
projects:
  - dir: template-setup/iac/environment
    workspace: stg
    workflow: stg
  - dir: template-setup/iac/environment
    workspace: prod
    workflow: prod
  - dir: template-setup/iac/common
workflows:
  stg:
    plan:
      steps:
        - init
        - plan:
            extra_args: ["-var-file", "stg.tfvars"]
  prod:
    plan:
      steps:
        - init
        - plan:
            extra_args: [ "-var-file", "prod.tfvars" ]
    # NOTE: no need to define the apply stage because it will default
    # to the normal apply stage.
